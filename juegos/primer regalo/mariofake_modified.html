<meta charset=utf-8>
<title>A por el primer regalo</title>

<body bgcolor=0>
    <center>
        <canvas width=1280 height=648 style="border:1px solid;background:#5C94FC;cursor:crosshair" id=a></canvas>
        <img src="img/assets.png" hidden id=b>
        <br>
        <p style="color:#444;font:normal 15px arial">
            <script>
                c = a.getContext("2d");
                localStorage["scpm"] = localStorage["scpm"] || 1;
                d = 0;
                n = 0;
                o = false;
                p = false;
                x = y = 0;
                s = 0;
                aa = ab = ac = 0;
                _ = 0;
                ad = 0;
                t = {};
                levels = [, {
                    hash: "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004444444444444000000000000000000000000000300000000000000000000000000000000000040030606060600000000000000000000000000604003000000000<0000000000000000000000000040030000000000000000000000000000000000004003000004444444000000000000000000000000400300000300000000000000000000000000000040030000030000000000000000000000000000004003000003000000000000000000000000000000400300000300000000000000000000000000000040030000030000000000000000002000000000004003000003000000000000000000000000000000400400F004000000000000000000000000000000400400G0040000000000000000000000000000;040044444440000000000000000003::::::::333300000000000000000000000000000000000000000",
                    I: [],
                    J: [],
                    txt: "Aim with mouse, send portals with left click and right click.",
                    ac: 284
                }, {
                        hash: "000000000000000000000000000000000000000004444000000000000000000000000000000000000400000000000000000000000000000000000000040000000000000000000000000000000000000004000000000000000000000000000000000000000400000000000000000000000000000000000000040000000000000000000000000000000000000004000000000000000000000000000000000000000400000000000000000000000000000000000000040000000000000000000000000000000000000004000000000000000000000000000000000000000400000000006000000000000000000000000000040000000000000000000000000000000000000004000000000000000000000000000000000002000400000000000000000000000000000000000000040000F000000000000000000000000000000000040000G00000000000000000000000000000000004444444444440000000000008888888888888800000000000000000000000000000000000000000",
                        I: [],
                        J: [],
                        txt: "Use Momentum!",
                        ac: 183
                    }, {
                        hash: "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000888888888888888888880000000000000000000030000000000000000008000000000000000000003000000000000000000800000000000000000000300200000000000000080000000000000000000030000000000000000008000000000000000000003000000000006000000800000000000000000000300000770000000000080000000000000000000044444444444440600008000000000000000000003000000000000000000800000000000000000000300000000000600000080000000000000000000030000000000000000008000000000000000000003000000000000000000800000000000000000000300F000000000000000800000000000000000000300G00000000000000080000000000000000000044444444444440000008000000000000000000000000000000000000000000000000000",
                        I: [],
                        J: [],
                        txt: "Portals bounce on ice!",
                        ac: 162
                    }, {
                        hash: "000000000000000000000000000000000000000008888888888888888888888888888888888888800800000000000000000000000000000000000080080000000000000000000000000000000000008008998000000000000000000000000000008:::8008998000000000000000000000000000008:::8008998000000000000000000000000000008:::8008008000000000000000000000000000008000800800800000000000000000000000000000800080080080000000000000000000000000000080008008008000000043333333333300000000008000800800800000044300000300000006666660800080080080000044430000030000000000000080008008008333333333000003002000333333338000800800800000000000000400000000000000000080080000000000000F000400000000000000000080080000000000000G0;040000000000000000008008000000000000333333333300000000000000800000000000000000000000000000000000000000",
                        I: [],
                        J: [],
                        ac: 528
                    }, {
                        hash: "00000000000000000044000000000000000000000000000000000000000000000000000000000000000000000000000002F000000000000000000000000000000000000000G0000000000000000000000000000000000000033000000000000000000000000000000000000000000000000000000000000000000000000060000000000060000000000000000000000000000000000000000000000000000000000000000006000000000000006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000000000000000000000000<6000000000000000000000000000000000000003300000000000000000000000000000000000000000000000000000000000000000000000000000000044000000000000000000",
                        I: [],
                        J: [[], [19, 7, 24, 4], [19, 9, 24, 15], [19, 11, 14, 15], [19, 13, 14, 4]],
                        ac: 446
                    }, {
                        hash: "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020300000000000000000000000000000000000000030000000000000000000000000000000000000003000000000000000000000000000000333333333300000000000000000000000000000030000000000000000000000000000000000000003000000000000000000000000000000000000000300000000000000000000000000000000000000030000000000000000000000000000000000000003000000000000000000000000306000000000000300000000000000000000000030000000F000000300000000000000000000000030000000G0000003000000000000000000000000333333333333333300000000000000000000000000000000000000000000000000000000",
                        I: [[21, 16, 8, 10, 16]],
                        J: [],
                        txt: "Need a little help from the past? Go to the time machine and press Shift!",
                        ac: 240
                    }, {
                        hash: "0000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000006660000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000333009990000000000000000000000000600::0000000000000000000000000000000000000:::000000000000000000000000000000000600::::00000000000000000000000000000000000:::::0000000000000000000000000000000600::::::000000000000000000000000000000000:::::::00000000000000000000000000000600::::::::0000000000000000000000000000000:::::::::0000000000000000000000F0000600::::::::::0000000000000000000000G00;000:::::::::::0000000000000000033333333333333333333333333333333333333333333333333333333333333333333333333333333",
                        I: [],
                        J: [],
                        ac: 309
                    }, {
                        hash: "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000003000000000000000000000000000000000000333300000000000000000000000000000000000030000000000000000000000000000000000000003000000000000000000000000000000000000000300000000000000000000000000000000000000030000000000000000000000000030F000000000030000000000000000000000000030G00000<00003000000000000000000000000003333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                        I: [],
                        J: [],
                        ac: 162
                    }, {
                        hash: "00000000000000000000000<0000000000000000000000000000020000000000000000000000000000000000000000000000000<0000000000000000000000000000000000000000000000000000000000000000000004000000000<0000000000000000000000000000000000000000000000000000000000000000000000000000000<0000F000000000000000000000000000000000000000G0000000000000000000000000000000000<0000000000000000000000000000000000000000000000000000000000000000000000000000000<0000000000000000000000000000000000000000000000000000000000000000000000000000000<0000000000000000000000000000000000000000000000000000000000000000000000000000000<0000000000000000000000000000000000000000000000000000000000000000000000000000000<000000000000000000000000033333333333333333333333000000000000000000000000000000000000000000000000",
                        I: [],
                        J: [],
                        ac: 360
                    }, {
                        hash: "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030000000000000000000030000000000000000003000000606060606060603000000000000000000300000000000000000000300000000000000000030999::::::::::::::::3000000000000000000300000000000000000000300000000000000000030000000000000000000030000000000000000003000000000000000000003000000000000000000300000000000000000020300000000000000000030000000000000000000030000000000000000003000000000000000000003000000000000000000300000000000000000000300000000000000000030000000000000000F00030000000000000000003000000;000000000G0003000000000000000000333333333333333333333300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                        I: [[11, 15, 7, 21, 15]],
                        J: [],
                        txt: "Sometimes you need to make multiple time travels...",
                        ac: 674
                    }, {
                        hash: "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000060000000000000000000000000000000000000006000000000000000000000000000000000;;;;;;;000000000000000000000000000000000333333300000000000020000000000000000000030000000000000000000000000000000000000003000000000000000003000000000000000000000300000000000000000300F000000000000000000300000000000000000300G0000000000000000003000000000000000003333339999999999993333300000000000000000000003000000000000300000000000000000000000000300000000000030000000000000000000000000030000000000003000000000000000000000000003333333333333300000000000000000000000000000000000000000000000000000000",
                        I: [[25, 12, 7, 17, 12]],
                        J: [],
                        txt: "If a past self dies or can't reach the time machine, it's a paradox! *wink the theme*",
                        txt2: "But you win if a past self reaches the flag!",
                        ac: 651
                    }, {
                        hash: "0000000000000000000000000000000000000000000000000000000000000000020300000000000000000000000000000000000000030000000000000000000000000000000000003333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030F000000000000000000000000000000000000030G000<00<00<000000000000000000000000000333333333333333300000000000000000000000000000000000000000000000000000000",
                        I: [],
                        J: [],
                        ac: 523
                    }, {
                        hash: "00000000000000000000000000000000000000000000000000000000000<00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000F000000000000000000000000000000000000000G000000000000000000000000000000000000033333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000<00033330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000<0<000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003333330000000000000000000000000000000000000000000000000000000000",
                        I: [],
                        J: [[14, 4, 19, 16]],
                        txt: "Heros and cubes have the same weight.",
                        ac: 335
                    }];
                AA = function (e, f, g) {
                    c.drawImage(b, e * 16, 0, 16, 16, f * 32, 40 + g * 32, 32, 32)
                }
                    ;
                AB = function (e, f, g) {
                    c.drawImage(b, e * 16, 0, 16, 16, f, g, 32, 32)
                }
                    ;
                AC = function (e, f, g) {
                    if (!t.x[~~(f / 32)])
                        return 0;
                    return t.x[~~(f / 32)][~~(e / 32)] || 0
                }
                    ;
                AD = function (e, f, g) {
                    if (!t.x[~~(f / 32)])
                        return;
                    t.x[~~(f / 32)][~~(e / 32)] = g
                }
                    ;
                AE = function (e, f, g) {
                    return e == 13 && Z != 0 || f && e == 7 || Q[e] || 0
                }
                    ;
                AF = function (e, f, g) {
                    if (!t.x[r])
                        return 0;
                    return !t.x[f][e] || t.x[f][e] < 14 || t.x[f][e] > 21
                }
                    ;
                AG = function (e, f, g) {
                    return {
                        x: t && t.Q ? t.Q[0] * 32 : 640,
                        y: t && t.Q ? t.Q[1] * 32 : 0,
                        e: 0,
                        f: 0,
                        d: 0,
                        D: ab || false,
                        j: [],
                        m: aa || false,
                        l: [],
                        E: ac || false,
                        g: [],
                        r: [],
                        F: [],
                        C: [],
                        z: [],
                        G: 0,
                        i: 1,
                        a: 0,
                        t: null,
                        o: null,
                        H: null,
                        v: 0,
                        n: true
                    }
                }
                    ;
                AH = function (e, f, g) {
                    I = false;
                    M = 0;
                    J = 0;
                    K = 0;
                    L = 0;
                    N = 0;
                    O = AG();
                    Q = [0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0];
                    t.u = [];
                    U = false;
                    V = [];
                    W = [];
                    X = {
                        q: -1,
                        r: -1
                    };
                    Y = {
                        q: -2,
                        r: -2
                    };
                    if (!e)
                        ae = []
                }
                    ;
                AI = function (e, f, g) {
                    t = {
                        x: [],
                        I: [],
                        J: [],
                        u: [],
                        K: false
                    };
                    for (j = 0; j < 20; j++)
                        t.x[j] = [];
                    pipe_click = 0;
                    v = 0;
                    w = 0;
                    z = 0;
                    A = 0;
                    G = true;
                    H = false
                }
                    ;
                AJ = function (e, f, g) {
                    AH(1);
                    t.x = [];
                    for (var j = 0; j < 20; j++) {
                        t.x[j] = [];
                        for (var i = 0; i < 40; i++) {
                            t.x[j][i] = t.hash.charCodeAt(j * 40 + i) - 48;
                            if (t.x[j][i] == 15)
                                t.x[j][i] = 0
                        }
                    }
                    for (var i in t.I)
                        V[i] = {
                            L: false,
                            y: t.I[i][1] * 32
                        };
                    for (var i in t.J)
                        W[i] = {
                            O: t.J[i][1] * 32,
                            P: t.J[i][3] * 32,
                            M: 0,
                            N: 0
                        }
                }
                    ;
                AK = function (e, f, g) {
                    for (j = 0; j < 20; j++)
                        for (i = 0; i < 40; i++) {
                            F = t.x[j][i];
                            if (F == 12) {
                                F = 0;
                                if (N == 0)
                                    t.u.push({
                                        x: i * 32,
                                        y: j * 32,
                                        f: 0,
                                        Z: null
                                    })
                            }
                            if (F == 13 && ae.length == 0) {
                                c.save();
                                c.globalAlpha = .5;
                                AA(F, i, j);
                                c.restore()
                            } else
                                AA(F, i, j);
                            if (F == 2 && N == 0) {
                                E = false;
                                if (j < 20)
                                    for (k = j + 1; k < 20; k++)
                                        if (!t.x[k][i] && !E) {
                                            AA(24, i, k);
                                            t.x[k][i] = 24
                                        } else
                                            E = true
                            }
                            if (F == 23 && N == 0) {
                                t.Q = [i, j];
                                O.x = t.Q[0] * 32;
                                O.y = t.Q[1] * 32
                            }
                        }
                    if (N == 0) {
                        for (Z in ae) {
                            ae[Z].x = t.Q[0] * 32;
                            ae[Z].y = t.Q[1] * 32;
                            ae[Z].e = 0;
                            ae[Z].f = 0;
                            ae[Z].D = false;
                            ae[Z].m = false;
                            ae[Z].E = false;
                            ae[Z].q = false;
                            ae[Z].i = 1;
                            ae[Z].s = 0;
                            ae[Z].t = null;
                            ae[Z].o = null;
                            ae[Z].H = null
                        }
                        for (i in t.u)
                            t.u[i].Z = null
                    }
                }
                    ;
                AL = function (e, f, g) {
                    if (typeof e.t != "undefined" && e.t !== null)
                        e.R = 1 + t.u[e.t].R;
                    if (e.o !== null && e.o != e.t) {
                        e.x = t.u[e.o].x + e.H;
                        e.y = t.u[e.o].y - 32;
                        e.o = null
                    }
                    if (e.e > 0) {
                        e.S = null;
                        if (AC(e.x + f + e.e, e.y + 16) == 4 && Y.q >= 0 && X.q == ~~((e.x + f + e.e) / 32) && X.r == ~~((e.y + 16) / 32) && X.T == 3)
                            e.S = Y;
                        if (AC(e.x + f + e.e, e.y + 16) == 4 && X.q >= 0 && Y.q == ~~((e.x + f + e.e) / 32) && Y.r == ~~((e.y + 16) / 32) && Y.T == 3)
                            e.S = X;
                        if (e.S) {
                            e.y = ~~((e.y + 16) / 32) * 32;
                            e.f = 0;
                            e.k = true;
                            if (AC(e.x + e.e, e.y + 16) == 4) {
                                e.U = true;
                                e.V = Math.max(e.e, 6);
                                e.e = 0;
                                e.c = 8
                            }
                        } else if (AE(AC(e.x + f + e.e, e.y)) || AE(AC(e.x + f + e.e, e.y + 31))) {
                            e.x = ~~((e.x + e.e) / 32) * 32 + 32 - f - 1;
                            e.e = 0
                        }
                        if (e.x > 1280 - f) {
                            e.x = 1280 - f;
                            e.e = 0
                        }
                        for (var j in t.I)
                            if (!e.k && e.x + f + e.e >= t.I[j][0] * 32 && e.x + f + e.e <= t.I[j][0] * 32 + 16 && e.y + 31 >= V[j].y && e.y <= V[j].W) {
                                e.x = t.I[j][0] * 32 - f - 1;
                                e.e = 0
                            }
                    }
                    if (e.e < 0) {
                        e.S = null;
                        if (AC(e.x + e.e, e.y + 16) == 4 && Y.q >= 0 && X.q == ~~((e.x + e.e) / 32) && X.r == ~~((e.y + 16) / 32) && X.T == 1)
                            e.S = Y;
                        if (AC(e.x + e.e, e.y + 16) == 4 && X.q >= 0 && Y.q == ~~((e.x + e.e) / 32) && Y.r == ~~((e.y + 16) / 32) && Y.T == 1)
                            e.S = X;
                        if (e.S) {
                            e.y = ~~((e.y + 16) / 32) * 32;
                            e.f = 0;
                            e.k = true;
                            if (AC(e.x + e.e + f, e.y + 16) == 4) {
                                e.U = true;
                                e.V = Math.max(-e.e, 6);
                                e.e = 0;
                                e.c = 8
                            }
                        } else if (AE(AC(e.x + e.e, e.y)) || AE(AC(e.x + e.e, e.y + 31))) {
                            e.x = ~~((e.x + e.e) / 32) * 32 + 32;
                            e.e = 0
                        }
                        if (e.x < 0) {
                            e.x = 0;
                            e.e = 0
                        }
                        for (j in t.I)
                            if (e.x + e.e >= t.I[j][0] * 32 + 64 - 16 && e.x + e.e <= t.I[j][0] * 32 + 64 && e.y + 31 >= V[j].y && e.y <= V[j].W) {
                                e.x = t.I[j][0] * 32 + 64;
                                e.e = 0
                            }
                    }
                    e.x += e.e;
                    if (!e.k) {
                        e.d = false;
                        e.f += 2;
                        if (e.f > 24)
                            e.f = 24
                    }
                    if (e.f > 0) {
                        e.S = null;
                        if (AC(e.x + f / 2, e.y + 32 + e.f) == 4 && Y.q >= 0 && X.q == ~~((e.x + f / 2) / 32) && X.r == ~~((e.y + 32 + e.f) / 32) && X.T == 0)
                            e.S = Y;
                        if (AC(e.x + e.e / 2, e.y + 32 + e.f) == 4 && X.q >= 0 && Y.q == ~~((e.x + f / 2) / 32) && Y.r == ~~((e.y + 32 + e.f) / 32) && Y.T == 0)
                            e.S = X;
                        if (e.S) {
                            e.x = ~~((e.x + f / 2) / 32) * 32 + (32 - f) / 2;
                            e.e = 0;
                            e.k = true;
                            if (e.f < 10 && AC(e.x + f / 2, e.y + 32 + e.f - 16) == 4 || e.f > 10 && AC(e.x + f / 2, e.y + 32 + e.f) == 4) {
                                e.U = true;
                                e.V = Math.max(e.f, 6);
                                e.f = 0;
                                e.c = 8
                            }
                        } else if (AE(AC(e.x, e.y + 32 + e.f)) || AE(AC(e.x + f - 1, e.y + 32 + e.f)) || g == 1 && AC(e.x, e.y + 32 + e.f) == 7 || g == 1 && AC(e.x + f - 1, e.y + 32 + e.f) == 7) {
                            e.y = ~~((e.y + e.f) / 32) * 32;
                            e.f = 0;
                            e.d = true
                        }
                        for (i in t.u)
                            if (!t.u[i].k && !e.k && e.x + f > t.u[i].x && e.x < t.u[i].x + 32 && e.y + 31 + e.f > t.u[i].y - 8 && e.y + 31 + e.f < t.u[i].y + 20) {
                                e.y = t.u[i].y - 32;
                                e.f = 0;
                                e.d = true;
                                e.o = i;
                                e.H = e.x - t.u[i].x;
                                t.u[i].R += e.R
                            }
                        for (j in t.I)
                            if (e.x + f - 1 >= t.I[j][0] * 32 && e.x < t.I[j][0] * 32 + 64 && e.y + 31 + e.f >= V[j].y && e.y + 31 + e.f <= V[j].y + 32) {
                                e.y = V[j].y - 32;
                                e.f = 0;
                                e.d = true;
                                e.b = true
                            }
                        for (j in t.J)
                            if (e.x + f >= t.J[j][0] * 32 - 32 && e.x < t.J[j][0] * 32 + 64 && e.y + 31 + e.f >= W[j].O - 8 && e.y + 31 + e.f <= W[j].O + 32) {
                                e.y = W[j].O - 32;
                                e.f = 0;
                                e.d = true;
                                e.b = true;
                                W[j].M += e.R
                            }
                        for (j in t.J)
                            if (e.x + f >= t.J[j][2] * 32 - 32 && e.x < t.J[j][2] * 32 + 64 && e.y + 31 + e.f >= W[j].P - 8 && e.y + 31 + e.f <= W[j].P + 32) {
                                e.y = W[j].P - 32;
                                e.f = 0;
                                e.d = true;
                                e.b = true;
                                W[j].N += e.R
                            }
                    }
                    if (e.f < 0) {
                        e.S = null;
                        if (AC(e.x + f / 2, e.y + e.f) == 4 && Y.q >= 0 && X.q == ~~((e.x + f / 2) / 32) && X.r == ~~((e.y + e.f) / 32) && X.T == 2)
                            e.S = Y;
                        if (AC(e.x + e.e / 2, e.y + e.f) == 4 && X.q >= 0 && Y.q == ~~((e.x + f / 2) / 32) && Y.r == ~~((e.y + e.f) / 32) && Y.T == 2)
                            e.S = X;
                        if (e.S) {
                            e.x = ~~((e.x + f / 2) / 32) * 32 + (32 - f) / 2;
                            e.e = 0;
                            e.k = true;
                            if (AC(e.x + f / 2, e.y + e.f + 10) == 4) {
                                e.U = true;
                                e.V = 6;
                                e.f = 0;
                                e.c = 8
                            }
                        } else if (AE(AC(e.x, e.y + e.f)) || AE(AC(e.x + f, e.y + e.f))) {
                            if (AC(e.x, e.y + e.f) == 5) {
                                AD(e.x, e.y + e.f, 0);
                                mkaudio(SNDbrick1).play()
                            }
                            if (AC(e.x + 24, e.y + e.f) == 5) {
                                AD(e.x + 24, e.y + e.f, 0);
                                mkaudio(SNDbrick1).play()
                            }
                            e.y = ~~((e.y + e.f) / 32) * 32 + 32;
                            e.f = 0
                        }
                    }
                    e.y += e.f;
                    if (e.U) {
                        e.U = false;
                        e.d = false;
                        mkaudio(SNDwhat0).play();
                        e.x = e.S.q * 32 + (32 - f) / 2;
                        e.y = e.S.r * 32;
                        if (e.S.T == 0) {
                            e.f = -e.V;
                            e.e = 0
                        }
                        if (e.S.T == 1) {
                            e.e = e.V;
                            e.f = 0;
                            e.x += 8
                        }
                        if (e.S.T == 2) {
                            e.f = e.V;
                            e.e = 0;
                            e.y += 8;
                            e.c = 2
                        }
                        if (e.S.T == 3) {
                            e.e = -e.V;
                            e.f = 0;
                            e.x -= 8
                        }
                    }
                    if (AC(e.x, e.y + 20) == 11) {
                        AD(e.x, e.y + 20, 25);
                        R = true
                    } else if (AC(e.x + f, e.y + 20) == 11) {
                        AD(e.x + f, e.y + 20, 25);
                        R = true
                    }
                    for (var i in t.I)
                        if (e.x + f >= t.I[i][3] * 32 && e.x <= t.I[i][3] * 32 + 32 && e.y + 32 >= t.I[i][4] * 32 && e.y + 20 <= t.I[i][4] * 32 + 32)
                            V[i].L = true
                }
                    ;
                AM = function (e, f, g) {
                    if (e.a != 3 && !I && !L) {
                        e.a = 0;
                        e.b = false;
                        if (!e.c) {
                            if (e.d && AC(e.x, e.y + 33) != 8 && AC(e.x + 24, e.y + 33) != 8 || !e.d && Math.abs(e.e) < 10)
                                e.e = 0;
                            if (e.g[N] && !((AC(e.x, e.y + 33) == 8 || AC(e.x + 24, e.y + 33) == 8) && e.e != 0)) {
                                if (e.i == 1)
                                    e.e = Math.max(e.e, 6);
                                else
                                    e.e = 0;
                                e.i = 1;
                                if (e.d)
                                    e.a = 1
                            }
                            if (e.j[N] && !((AC(e.x, e.y + 33) == 8 || AC(e.x + 24, e.y + 33) == 8) && e.e != 0)) {
                                if (e.i == 0)
                                    e.e = Math.min(e.e, -6);
                                else
                                    e.e = 0;
                                e.i = 0;
                                if (e.d)
                                    e.a = 1
                            }
                        }
                        if (!e.k && e.l[N] && e.d && !((AC(e.x, e.y + 33) == 8 || AC(e.x + 24, e.y + 33) == 8) && e.e != 0)) {
                            e.f -= 20;
                            e.d = false;
                            e.m = false;
                            e.n = false;
                            e.o = null;
                            mkaudio(SNDjump2).play()
                        }
                        if (e.f < 0 && !e.d)
                            e.a = 2;
                        AL(e, 24, 0);
                        if (AC(e.x + 24 / 2 - 8, e.y + 16 - 8) == 6) {
                            AD(e.x + 24 / 2 - 8, e.y + 16 - 8, 0);
                            mkaudio(SNDcoin1).play()
                        }
                        if (AC(e.x + 24 / 2 + 8, e.y + 16 - 8) == 6) {
                            AD(e.x + 24 / 2 + 8, e.y + 16 - 8, 0);
                            mkaudio(SNDcoin1).play()
                        }
                        if (AC(e.x + 24 / 2 - 8, e.y + 16 + 8) == 6) {
                            AD(e.x + 24 / 2 - 8, e.y + 16 + 8, 0);
                            mkaudio(SNDcoin1).play()
                        }
                        if (AC(e.x + 24 / 2 + 8, e.y + 16 + 8) == 6) {
                            AD(e.x + 24 / 2 + 8, e.y + 16 + 8, 0);
                            mkaudio(SNDcoin1).play()
                        }
                        if (e.F[N])
                            if (AC(e.x, e.y) == 23 || AC(e.x + 24, e.y) == 23 || AC(e.x, e.y + 31) == 23 || AC(e.x + 24, e.y + 31) == 23) {
                                if (!f) {
                                    e.p = N;
                                    ae.push(e);
                                    N = -1;
                                    O = AG()
                                } else
                                    e.q = true;
                                mkaudio(SNDtimetravel0).play()
                            }
                        if (AC(e.x + 3, e.y) == 7 || AC(e.x + 24 - 3, e.y) == 7 || AC(e.x + 3, e.y + 5) == 7 || AC(e.x + 24 - 3, e.y + 5) == 7) {
                            e.a = 3;
                            e.f = -1 * 20
                        }
                        if (e.y > 648) {
                            e.a = 3;
                            e.f = -1.5 * 20
                        }
                        if (AC(e.x + 1, e.y + 1) == 9 || AC(e.x + 24 - 1, e.y + 1) == 9 || AC(e.x + 1, e.y + 31) == 9 || AC(e.x + 24 - 1, e.y + 31) == 9) {
                            e.a = 3;
                            e.f = -1.5 * 20
                        }
                        if (e.b && (AE(AC(e.x, e.y + 1)) || AE(AC(e.x + 24, e.y + 1)))) {
                            e.a = 3;
                            e.f = -1 * 20
                        }
                        if (e.r[N])
                            e.s ^= 1;
                        if (e.s) {
                            if (e.t === null)
                                for (i in t.u)
                                    if (e.x + 24 >= t.u[i].x && e.x <= t.u[i].x + 31 && e.y + 31 + 4 >= t.u[i].y && e.y <= t.u[i].y + 31) {
                                        e.t = i;
                                        t.u[i].Z = e;
                                        e.v = 5;
                                        break
                                    }
                        } else if ($ = t.u[e.t]) {
                            $.x = e.x;
                            $.o = null;
                            if (!e.d)
                                if (e.i == 0)
                                    $.e = -14;
                                else
                                    $.e = 14;
                            if (AE(AC($.x, $.y)))
                                $.x = ~~($.x / 32) * 32 + 32;
                            else if (AE(AC($.x, $.y + 31)))
                                $.x = ~~($.x / 32) * 32 + 32;
                            else if (AE(AC($.x + 32, $.y)))
                                $.x = ~~($.x / 32) * 32 - 1;
                            else if (AE(AC($.x + 32, $.y + 31)))
                                $.x = ~~($.x / 32) * 32 - 1;
                            $.Z = null;
                            t.u[e.t] = $;
                            e.t = null;
                            e.R = 1
                        }
                        if (e.t !== null) {
                            if (e.i == 0)
                                t.u[e.t].x = e.x - 6;
                            if (e.i == 1)
                                t.u[e.t].x = e.x - 4;
                            if (e.v)
                                e.v--;
                            if (e.k)
                                t.u[e.t].y = e.y;
                            else if (AE(AC(e.x, e.y - 28)) || AE(AC(e.x + 24, e.y - 28)))
                                t.u[e.t].y = ~~((e.y + 4) / 32) * 32;
                            else
                                t.u[e.t].y = e.y - 32 + e.v * 4
                        } else
                            e.s = 0;
                        if (AC(e.x + 24 / 2, e.y + 16) == 2 || AC(e.x + 24 / 2, e.y + 16) == 24) {
                            M = 0;
                            for (j = 0; j < 20; j++)
                                for (i = 0; i < 40; i++)
                                    if (t.x[j][i] == 6)
                                        M++;
                            if (M == 0) {
                                I = true;

                                if (s === 1) { // Verifica si es el primer nivel
                                    setTimeout(() => {
                                        window.location.href = "primerRegalo.html"; // Redirige a la nueva p√°gina tras un retraso
                                    }, 2000); // 2000 ms = 2 segundos de espera
                                }
                            }
                        }
                        if (!e.k && (e.C[N] || e.z[N])) {
                            mkaudio(SNDshoot1).play();
                            e.A = 0;
                            e.B = 0;
                            if (e.C[N]) {
                                e.A = 1;
                                e.G = Math.atan2(e.C[N][0] - (e.x + 24 / 2), e.C[N][1] - (e.y + 40 + 16))
                            }
                            if (e.z[N]) {
                                e.B = 1;
                                e.G = Math.atan2(e.z[N][0] - (e.x + 24 / 2), e.z[N][1] - (e.y + 40 + 16))
                            }
                            e.X = e.x + 24 / 2;
                            e.Y = e.y + 16;
                            e.Z = Math.sin(e.G);
                            e.aa = Math.cos(e.G)
                        }
                        for (ah in ag = [["A", X, "blue"], ["B", Y, "orange"]])
                            if (e[ag[ah][0]])
                                for (i = 0; i < 40; i++) {
                                    e[ag[ah][0]] += .001;
                                    e.X += e[ag[ah][0]] * e.Z;
                                    e.Y += e[ag[ah][0]] * e.aa;
                                    if (AE(AC(e.X, e.Y)) || AC(e.X, e.Y) == 7) {
                                        e[ag[ah][0]] = 0;
                                        if (e.X % 32 < 4 && !AE(AC(e.X - 32, e.Y)) && e.Z > 0)
                                            m = 3;
                                        if (e.X % 32 > 28 && !AE(AC(e.X + 32, e.Y)) && e.Z < 0)
                                            m = 1;
                                        if (e.Y % 32 < 4 && !AE(AC(e.X, e.Y - 32)) && e.aa > 0)
                                            m = 0;
                                        if (e.Y % 32 > 28 && !AE(AC(e.X, e.Y + 32)) && e.aa < 0)
                                            m = 2;
                                        if (AC(e.X, e.Y) == 8) {
                                            mkaudio(SNDshoot1).play();
                                            e[ag[ah][0]] = 1;
                                            if (m == 0) {
                                                e.aa = -e.aa;
                                                e.Y = ~~(e.Y / 32) * 32 - 1
                                            } else if (m == 2) {
                                                e.aa = -e.aa;
                                                e.Y = ~~(e.Y / 32) * 32 + 32 + 1
                                            } else if (m == 1) {
                                                e.Z = -e.Z;
                                                e.X = ~~(e.X / 32) * 32 + 32 + 1
                                            } else {
                                                e.Z = -e.Z;
                                                e.X = ~~(e.X / 32) * 32 - 1
                                            }
                                        }
                                        if (AC(e.X, e.Y) == 4 && (~~(e.X / 32) != ag[1 - ah][1].q || ~~(e.Y / 32) != ag[1 - ah][1].r || ag[1 - ah][1].T != m)) {
                                            ag[ah][1].q = ~~(e.X / 32);
                                            ag[ah][1].r = ~~(e.Y / 32);
                                            ag[ah][1].T = m;
                                            mkaudio(SNDwhatportal2).play()
                                        }
                                        break
                                    } else {
                                        c.fillStyle = ag[ah][2];
                                        c.fillRect(e.X, e.Y + 40, 6, 6)
                                    }
                                }
                        if (AC(e.x + 1, e.y + 1) != 4 && AC(e.x + 24 - 1, e.y + 1) != 4 && AC(e.x + 1, e.y + 31) != 4 && AC(e.x + +24 - 1, e.y + 31) != 4)
                            e.k = false;
                        if (e.c)
                            e.c--
                    }
                    if (e.a == 3) {
                        e.f += 2;
                        if (e.f > 24)
                            e.f = 24;
                        e.y += e.f
                    }
                }
                    ;
                AN = function (e, f, g) {
                    c.save();
                    c.translate(e.x + 24 / 2 - 2, e.y);
                    if (e.i == 0)
                        c.scale(-1, 1);
                    if (f)
                        c.globalAlpha = .75;
                    else if (ae.length) {
                        c.fillStyle = "#fff";
                        c.fillText("\u25bc", 0, 10)
                    }
                    if (!(f && N > e.p))
                        c.drawImage(b, [26, [27, 28, 29][~~(N / 2) % 3], 30, 31][e.a] * 16, 0, 16, 16, -24 / 2, 40, 32, 32);
                    c.restore()
                }
                    ;
                onclick = oncontextmenu = function (e, f, g) {
                    AO(e);
                    return false
                }
                    ;
                onmousedown = function (e, f, g) {
                    o = true;
                    if (e.which == 3)
                        p = true;
                    else
                        p = false
                }
                    ;
                onmouseup = function (e, f, g) {
                    o = false
                }
                    ;
                onmousemove = function (e, f, g) {
                    x = e.pageX - a.getBoundingClientRect().left - document.documentElement.scrollLeft - document.body.scrollLeft;
                    y = e.pageY - a.getBoundingClientRect().top - document.documentElement.scrollTop - document.body.scrollTop;
                    q = Math.floor(x / 32);
                    r = Math.floor((y - 40) / 32);
                    if (d == 3) {
                        if (o && A != 14 && A != 15)
                            AO(e);
                        AP(1)
                    }
                }
                    ;
                AO = function (e, f, g) {
                    if (d == 0) {
                        c.beginPath();
                        c.rect(1230, 0, 90, 90);
                        if (c.isPointInPath(x, y)) {
                            mute = !mute;
                            if (mute)
                                MM.stop();
                            else
                                Music();
                            AP()
                        }
                        c.closePath();
                        c.beginPath();
                        c.rect(500, 400, 100, 80);
                        if (c.isPointInPath(x, y)) {
                            d = 2;
                            s = 1; // Primer nivel.
                            t = levels[1];
                            AP();
                        }
                        c.closePath();
                        c.beginPath();
                        c.rect(650, 400, 100, 80);
                        if (c.isPointInPath(x, y)) {
                            d = 3;
                            AI();
                            AP()
                        }
                        c.closePath()
                    }
                    if (d == 1) {
                        c.beginPath();
                        c.rect(30, 30, 50, 50);
                        if (c.isPointInPath(x, y)) {
                            d = 0;
                            AP()
                        }
                        c.closePath();
                        c.beginPath();
                        c.rect(590, 520, 100, 80);
                        if (c.isPointInPath(x, y))
                            open("//goo.gl/oBx0S1");
                        c.closePath();
                        for (i = 0; i < 10; i++)
                            for (j = 0; j < 3; j++) {
                                m = j * 10 + i + 1;
                                if (+localStorage["scpm"] >= m) {
                                    c.beginPath();
                                    c.rect(i * 120 + 50, j * 100 + 120, 100, 80);
                                    if (c.isPointInPath(x, y)) {
                                        n = 1;
                                        d = 2;
                                        _ = 0;
                                        s = m;
                                        t = levels[m];
                                        AP()
                                    }
                                    c.closePath()
                                }
                            }
                        if (+localStorage["scpm"] >= 30) {
                            c.beginPath();
                            c.rect(50, 420, 100, 80);
                            if (c.isPointInPath(x, y)) {
                                n = 1;
                                d = 2;
                                _ = 0;
                                m = 31;
                                s = m;
                                t = levels[m];
                                AP()
                            }
                            c.closePath()
                        }
                    }
                    if (d == 2 && N > 0) {
                        if (e.which == 1)
                            O.C[N] = [x, y];
                        if (e.which == 3)
                            O.z[N] = [x, y];
                        c.beginPath();
                        c.rect(1240, 0, 32, 32);
                        if (c.isPointInPath(x, y)) {
                            clearInterval(ad);
                            d = n;
                            AP()
                        }
                        c.closePath()
                    }
                    if (d == 3) {
                        t.hash = "";
                        for (j = 0; j < 20; j++)
                            for (i = 0; i < 40; i++) {
                                tile = t.x[j][i] || 0;
                                tile = tile < 16 || tile > 21 ? tile : 0;
                                t.hash += String.fromCharCode(tile + 48)
                            }
                        c.beginPath();
                        c.rect(750, 4, 100, 32);
                        if (c.isPointInPath(x, y)) {
                            n = 3;
                            d = 2;
                            AP()
                        }
                        c.closePath();
                        c.beginPath();
                        c.rect(875, 4, 100, 32);
                        if (c.isPointInPath(x, y)) {
                            location.hash = "";
                            if (t.K == false)
                                alert("You need to test and I your level first.");
                            else {
                                open("//www.twitter.com/intent/tweet?text=" + encodeURIComponent("I made a level for #SuperChronoPortalMaker !\nPlay the game here: http://js13kgames.com/entries/super-chrono-portal-maker. \nPlay my level here: " + encodeURI(location.origin + location.pathname + "#" + JSON.stringify({
                                    hash: t.hash,
                                    I: t.I,
                                    J: t.J
                                }))));
                                G = true
                            }
                        }
                        c.closePath();
                        c.beginPath();
                        c.rect(1E3, 4, 100, 32);
                        if (c.isPointInPath(x, y)) {
                            AI();
                            AP()
                        }
                        c.closePath();
                        c.beginPath();
                        c.rect(1125, 4, 100, 32);
                        if (c.isPointInPath(x, y))
                            if (G || !G && confirm("Quit? This level will be lost!")) {
                                d = 0;
                                AP()
                            }
                        c.closePath();
                        for (i = 0; i < 16; i++) {
                            c.beginPath();
                            c.rect(8.5 + i * 35, 3.5, 32, 32);
                            if (c.isPointInPath(x, y) && pipe_click == 0 && w == 0) {
                                H = true;
                                A = i;
                                if (A == 14)
                                    t.I[v] = [];
                                if (A == 15)
                                    t.J[z] = [];
                                AP()
                            }
                            c.closePath()
                        }
                        c.beginPath();
                        c.rect(0, 40, 1280, 608);
                        if (c.isPointInPath(x, y)) {
                            if (H)
                                G = false;
                            t.K = false;
                            if (p == true) {
                                if (t.x[r][q] == 22) {
                                    t.x[r][q] = 0;
                                    t.x[r + 1][q] = 0
                                }
                                if (t.x[r][q] == 23) {
                                    t.x[r][q] = 0;
                                    t.x[r - 1][q] = 0
                                }
                                if (AF(q, r))
                                    t.x[r][q] = 0;
                                if (pipe_click == 0) {
                                    if (t.x[r][q] == 16)
                                        for (i in t.I)
                                            if (t.I[i][0] == q && (t.I[i][1] == r || t.I[i][2] == r)) {
                                                for (j = t.I[i][1]; j < 20; j++)
                                                    if (t.x[j][q] == 16 || t.x[j][q] == 18) {
                                                        t.x[j][q] = 0;
                                                        t.x[j][q + 1] = 0
                                                    } else
                                                        break;
                                                for (j = t.I[i][2]; j < 20; j++)
                                                    if (t.x[j][q] == 16 || t.x[j][q] == 18) {
                                                        t.x[j][q] = 0;
                                                        t.x[j][q + 1] = 0
                                                    } else
                                                        break;
                                                t.x[t.I[i][4]][t.I[i][3]] = 0;
                                                delete t.I[i]
                                            }
                                    if (t.x[r][q] == 17)
                                        for (i in t.I)
                                            if (t.I[i][0] == q - 1 && (t.I[i][1] == r || t.I[i][2] == r)) {
                                                for (j = t.I[i][1]; j < 20; j++)
                                                    if (t.x[j][q] == 17 || t.x[j][q] == 19) {
                                                        t.x[j][q] = 0;
                                                        t.x[j][q - 1] = 0
                                                    } else
                                                        break;
                                                for (j = t.I[i][2]; j < 20; j++)
                                                    if (t.x[j][q] == 17 || t.x[j][q] == 19) {
                                                        t.x[j][q] = 0;
                                                        t.x[j][q - 1] = 0
                                                    } else
                                                        break;
                                                t.x[t.I[i][4]][t.I[i][3]] = 0;
                                                delete t.I[i]
                                            }
                                    t.ab = t.I;
                                    t.I = [];
                                    for (i in t.ab)
                                        if (t.ab[i])
                                            t.I.push(t.ab[i])
                                }
                                if (w == 0) {
                                    if (t.x[r][q] == 15)
                                        for (i in t.J)
                                            if (t.J[i][1] == r && (t.J[i][0] == q || t.J[i][0] == q - 1 || t.J[i][0] == q + 1) || t.J[i][3] == r && (t.J[i][2] == q || t.J[i][2] == q - 1 || t.J[i][2] == q + 1)) {
                                                t.x[t.J[i][1]][t.J[i][0]] = 0;
                                                t.x[t.J[i][1]][t.J[i][0] - 1] = 0;
                                                t.x[t.J[i][1]][t.J[i][0] + 1] = 0;
                                                t.x[t.J[i][3]][t.J[i][2]] = 0;
                                                t.x[t.J[i][3]][t.J[i][2] - 1] = 0;
                                                t.x[t.J[i][3]][t.J[i][2] + 1] = 0;
                                                delete t.J[i]
                                            }
                                    t.ab = t.J;
                                    t.J = [];
                                    for (i in t.ab)
                                        if (t.ab[i])
                                            t.J.push(t.ab[i])
                                }
                            } else if (A == 1) {
                                if (r > 0 && AF(q, r) && AF(q, r - 1)) {
                                    for (j in t.x)
                                        for (i in t.x[j])
                                            if (t.x[j][i] == 22 || t.x[j][i] == 23)
                                                t.x[j][i] = 0;
                                    t.x[r - 1][q] = 22;
                                    t.x[r][q] = 23
                                }
                            } else if (A == 2) {
                                if (AF(q, r)) {
                                    for (j in t.x)
                                        for (i in t.x[j])
                                            if (t.x[j][i] == 2)
                                                t.x[j][i] = 0;
                                    t.x[r][q] = 2
                                }
                            } else if (A == 14) {
                                if (AF(q, r) && AF(q + 1, r))
                                    if (pipe_click == 0) {
                                        t.I[v] = [];
                                        t.I[v][0] = q;
                                        t.I[v][1] = r;
                                        t.x[r][q] = 16;
                                        t.x[r][q + 1] = 17;
                                        pipe_click++
                                    } else if (pipe_click == 1) {
                                        if (true) {
                                            t.I[v][2] = r;
                                            t.x[r][t.I[v][0]] = 16;
                                            t.x[r][t.I[v][0] + 1] = 17;
                                            pipe_click++
                                        }
                                    } else if (pipe_click == 2) {
                                        t.I[v][3] = q;
                                        t.I[v][4] = r;
                                        t.x[r][q] = 20;
                                        v++;
                                        pipe_click = 0
                                    }
                            } else if (A == 15) {
                                if (AF(q - 1, r) && AF(q, r) && AF(q + 1, r)) {
                                    if (w == 0) {
                                        t.J[z] = [];
                                        t.J[z][0] = q;
                                        t.J[z][1] = r;
                                        w++
                                    } else if (w == 1) {
                                        t.J[z][2] = q;
                                        t.J[z][3] = r;
                                        z++;
                                        w = 0
                                    }
                                    t.x[r][q - 1] = 15;
                                    t.x[r][q] = 15;
                                    t.x[r][q + 1] = 15
                                }
                            } else if (AF(q, r))
                                t.x[r][q] = A;
                            AP(1)
                        }
                        c.closePath()
                    }
                }
                    ;
                onkeydown = function (e, f, g) {
                    if (d == 2) {
                        if (e.keyCode == 38 || e.keyCode == 90 || e.keyCode == 87)
                            if (O.n) {
                                O.m = true;
                                O.n = false;
                                aa = true
                            }
                        if (e.keyCode == 39 || e.keyCode == 68) {
                            O.E = true;
                            ac = true
                        }
                        if (e.keyCode == 37 || e.keyCode == 65 || e.keyCode == 81) {
                            O.D = true;
                            ab = true
                        }
                    }
                }
                    ;
                onkeyup = function (e, f, g) {
                    if (d == 2) {
                        if (e.keyCode == 38 || e.keyCode == 90 || e.keyCode == 87) {
                            O.m = false;
                            O.n = true;
                            aa = false
                        }
                        if (e.keyCode == 39 || e.keyCode == 68) {
                            O.E = false;
                            ac = false
                        }
                        if (e.keyCode == 37 || e.keyCode == 65 || e.keyCode == 81) {
                            O.D = false;
                            ab = false
                        }
                        if (e.keyCode == 82) {
                            AH();
                            _ = 0
                        }
                        if (e.keyCode == 32)
                            O.r[N] = true;
                        if (e.keyCode == 16)
                            O.F[N] = true
                    }
                }
                    ;
                mute = false;
                AP = onload = onhashchange = function (e, f, g) {
                    a.width ^= 0;
                    c.font = "bold 30px arial";
                    c.textAlign = "center";
                    c["mozImageSmoothingEnabled"] = false;
                    c["imageSmoothingEnabled"] = false;
                    if (d == 0) {
                        a.style.cursor = "pointer";
                        t = {
                            hash: "0000==0000000000000000000000000000000000000====0000000000000000000000000000000000000000000000000000000000000000===000000000000000000000000000000000000=====00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000900000000000000059595000000000000000000000000000000000000000000000@A00000000000000000000000000000000000000BC00J00000000000000000000000000000000000BC03333333333333333333333333333333333333333",
                            I: [[35, 15, 17, 40, 17]],
                            J: []
                        };
                        ae = [,];
                        AJ();
                        AK();
                        c.drawImage(b, 512, 0, 70, 16, 120, 150, 280, 64);
                        c.drawImage(b, 583, 0, 270, 16, 120, 250, 1080, 64);
                        c.fillStyle = "#000";
                        c.beginPath();
                        c.fillRect(500, 400, 100, 80);
                        c.fillRect(650, 400, 100, 80);
                        c.fillStyle = "#fff";
                        c.fillText("INFO", 700, 450);
                        c.fillText("PLAY", 550, 450);
                        c.fillText(mute ? "\ud83d\udd0a" : "\ud83d\udd07", 1250, 40);
                        c.stroke();
                        c.closePath()
                    }
                    if (d == 1) {
                        a.style.cursor = "pointer";
                        c.beginPath();
                        c.fillStyle = "#000";
                        c.fillRect(590, 520, 100, 80);
                        k = 0;
                        for (i = 0; i < 10; i++)
                            for (j = 0; j < 3; j++) {
                                l = j * 10 + i + 1;
                                c.fillStyle = "#000";
                                c.fillRect(i * 120 + 50, j * 100 + 120, 100, 80);
                                c.fillStyle = "#fff";
                                c.fillText(+localStorage["scpm"] >= l ? l : "?", i * 120 + 100, j * 100 + 170);
                                if (localStorage["scpm" + l] <= levels[l].ac)
                                    c.fillText("\ud83c\udfc5", i * 120 + 135, j * 100 + 145);
                                k += +localStorage["scpm" + l] || 0
                            }
                        if (+localStorage["scpm"] >= 30) {
                            c.fillStyle = "#000";
                            c.fillRect(50, 420, 100, 80);
                            c.fillStyle = "#fff";
                            c.fillText(+localStorage["scpm"] >= 31 ? 31 : "?", 100, 470);
                            if (localStorage["scpm" + l] <= levels[l].ac)
                                c.fillText("\ud83c\udfc5", 135, 445)
                        }
                        c.fillText("\u25c0", 40, 70);
                        c.fillStyle = "#000";
                        c.fillText("JS13K LEVELS", 642, 72);
                        c.fillText("TWITTER LEVELS", 642, 472);
                        c.fillStyle = "#fff";
                        c.fillText("JS13K LEVELS", 640, 70);
                        c.fillText("TWITTER LEVELS", 640, 470);
                        c.fillText("GO", 640, 570);
                        c.fillStyle = "#000";
                        if (k)
                            c.fillText("Total time: " + ~~(k / 30 / 60) + ":" + ("0" + (k / 30 % 60).toFixed(2)).slice(-5), 1100, 450);
                        c.stroke();
                        c.closePath()
                    }
                    if (d == 2) {
                        a.style.cursor = "crosshair";
                        if (ad)
                            clearInterval(ad);
                        AH();
                        ad = setInterval(function () {
                            a.width ^= 0;
                            c.font = "bold 30px arial";
                            c.fillStyle = "#000";
                            c.fillText("\u00d7", 1255, 25);
                            if (n == 1) {
                                c.font = "bold 30px arial";
                                c.textAlign = "center";
                                c.lineJoin = "round";
                                c.fillStyle = "#000";
                                c.fillText(t.txt || "", 642, 82);
                                c.fillText(t.txt2 || "", 642, 122);
                                c.fillStyle = "#fff";
                                c.fillText(t.txt || "", 640, 80);
                                c.fillText(t.txt2 || "", 640, 120)
                            }
                            if (O.D)
                                O.j[N] = true;
                            if (O.E)
                                O.g[N] = true;
                            if (O.m)
                                O.l[N] = true;
                            c.mozImageSmoothingEnabled = false;
                            c.imageSmoothingEnabled = false;
                            if (N == 0)
                                AJ();
                            for (var i in t.I) {
                                if (V[i].L)
                                    af = t.I[i][2] * 32;
                                else
                                    af = t.I[i][1] * 32;
                                if (V[i].y > af)
                                    V[i].y = Math.max(V[i].y - 4, af);
                                else if (V[i].y < af)
                                    V[i].y = Math.min(V[i].y + 4, af);
                                D = false;
                                for (var k = ~~(V[i].y / 32) + 1; k < 21; k++)
                                    if (k < 20 && !AE(AC(t.I[i][0] * 32, k * 32)) && !AE(AC(t.I[i][0] * 32 + 1 * 32, k * 32)) && !D) {
                                        AA(18, t.I[i][0], k);
                                        AA(19, t.I[i][0] + 1, k)
                                    } else {
                                        D = true;
                                        V[i].W = k * 32;
                                        break
                                    }
                                AB(16, t.I[i][0] * 32, V[i].y + 40);
                                AB(17, t.I[i][0] * 32 + 32, V[i].y + 40);
                                if (t.I[i][4])
                                    if (V[i].L)
                                        AA(21, t.I[i][3], t.I[i][4]);
                                    else
                                        AA(20, t.I[i][3], t.I[i][4])
                            }
                            AK();
                            R = false;
                            for (j = 0; j < 20; j++)
                                for (i = 0; i < 40; i++)
                                    if (t.x[j][i] == 25)
                                        t.x[j][i] = 11;
                            for (i in t.I)
                                V[i].L = false;
                            O.R = 1;
                            for (i in t.u)
                                t.u[i].R = 1;
                            for (i in t.J) {
                                W[i].M = 0;
                                W[i].N = 0
                            }
                            for (Z in ae)
                                AM(ae[Z], 1);
                            if (ae.length)
                                Z = -1;
                            else
                                Z = 0;
                            AM(O);
                            for (i in t.u) {
                                if (AC(t.u[i].x + 1, t.u[i].y + 1) != 4 && AC(t.u[i].x + 32 - 1, t.u[i].y + 1) != 4 && AC(t.u[i].x + 1, t.u[i].y + 31) != 4 && AC(t.u[i].x + 32 - 1, t.u[i].y + 31) != 4)
                                    t.u[i].k = false;
                                if (t.u[i].c)
                                    t.u[i].c--;
                                if (t.u[i].Z === null) {
                                    if (!t.u[i].c && !AE(AC(t.u[i].x, t.u[i].y + 31)) && !AE(AC(t.u[i].x + 31, t.u[i].y + 31)))
                                        if (t.u[i].e > 1)
                                            t.u[i].e -= 1;
                                        else if (t.u[i].e < -1)
                                            t.u[i].e += 1;
                                        else
                                            t.u[i].e = 0;
                                    AL(t.u[i], 32, 1)
                                }
                                c.drawImage(b, 12 * 16, 0, 16, 16, t.u[i].x, 40 + t.u[i].y, 32, 32)
                            }
                            for (Z in ae)
                                AN(ae[Z], 1);
                            AN(O);
                            for (i in j = {
                                "blue": X,
                                "orange": Y
                            })
                                AA(4, j[i].q, j[i].r);
                            for (i in j = {
                                "blue": X,
                                "orange": Y
                            }) {
                                c.fillStyle = i;
                                if (j[i].T == 0)
                                    c.fillRect(j[i].q * 32, j[i].r * 32 + 40 - 8, 32, 8);
                                if (j[i].T == 1)
                                    c.fillRect(j[i].q * 32 + 28, j[i].r * 32 + 40, 8, 32);
                                if (j[i].T == 2)
                                    c.fillRect(j[i].q * 32, j[i].r * 32 + 40 + 28, 32, 8);
                                if (j[i].T == 3)
                                    c.fillRect(j[i].q * 32 - 4, j[i].r * 32 + 40, 8, 32)
                            }
                            if (R != U) {
                                mkaudio(SNDswitch0).play();
                                for (j = 0; j < 20; j++)
                                    for (i = 0; i < 40; i++)
                                        if (t.x[j][i] == 9)
                                            t.x[j][i] = 10;
                                        else if (t.x[j][i] == 10)
                                            t.x[j][i] = 9
                            }
                            U = R;
                            for (i in t.J) {
                                if (W[i].M > W[i].N && !AE(AC(t.J[i][0] * 32 - 32, W[i].O + 20)) && !AE(AC(t.J[i][0] * 32, W[i].O + 20)) && !AE(AC(t.J[i][0] * 32 + 32, W[i].O + 20)) && !AE(AC(t.J[i][2] * 32 - 32, W[i].P - 4)) && !AE(AC(t.J[i][2] * 32, W[i].P - 4)) && !AE(AC(t.J[i][2] * 32 + 32, W[i].P - 4))) {
                                    W[i].O += 4;
                                    W[i].P -= 4
                                } else if (W[i].N > W[i].M && !AE(AC(t.J[i][2] * 32 - 32, W[i].P + 20)) && !AE(AC(t.J[i][2] * 32, W[i].P + 20)) && !AE(AC(t.J[i][2] * 32 + 32, W[i].P + 20)) && !AE(AC(t.J[i][0] * 32 - 32, W[i].O - 4)) && !AE(AC(t.J[i][0] * 32, W[i].O - 4)) && !AE(AC(t.J[i][0] * 32 + 32, W[i].O - 4))) {
                                    W[i].O -= 4;
                                    W[i].P += 4
                                }
                                c.beginPath();
                                c.strokeStyle = "#fff";
                                c.lineWidth = 2;
                                c.moveTo(t.J[i][0] * 32 + 16, W[i].O + 40 + 8);
                                c.lineTo(t.J[i][2] * 32 + 16, W[i].P + 40 + 8);
                                c.stroke();
                                c.closePath();
                                AB(15, t.J[i][0] * 32 - 32, W[i].O + 40);
                                AB(15, t.J[i][0] * 32, W[i].O + 40);
                                AB(15, t.J[i][0] * 32 + 32, W[i].O + 40);
                                AB(15, t.J[i][2] * 32 - 32, W[i].P + 40);
                                AB(15, t.J[i][2] * 32, W[i].P + 40);
                                AB(15, t.J[i][2] * 32 + 32, W[i].P + 40)
                            }
                            N++;
                            if (!I)
                                _++;
                            c.font = "bold 100px arial";
                            c.fillStyle = "#000";
                            c.textAlign = "center";
                            if (I) {
                                J++;
                                c.fillText("CLEARED!", 640, 300);
                                c.font = "bold 30px arial";
                                if (n == 1) {
                                    c.fillRect(450, 350, 400, 130);
                                    c.fillStyle = "#fff";
                                    c.fillText("Time: " + (_ / 30).toFixed(2) + "s", 640, 400);
                                    c.fillText("Dev record: " + (t.ac / 30).toFixed(2) + "s", 640, 450);
                                    if (localStorage["scpm" + s])
                                        localStorage["scpm" + s] = Math.min(+localStorage["scpm" + s], _);
                                    else
                                        localStorage["scpm" + s] = _
                                }
                            }
                            if (O.a == 3) {
                                K++;
                                c.fillText("LOST!", 640, 350)
                            }
                            for (Z in ae)
                                if (ae[Z].a == 3 || ae[Z].p < N && !ae[Z].q && !I) {
                                    L++;
                                    c.fillText("PARADOX!", 640, 350)
                                }
                            if (J == 1)
                                mkaudio(SNDI0).play();
                            if (K == 1)
                                mkaudio(SNDdie0).play();
                            if (L == 1)
                                mkaudio(SNDglitch1).play();
                            if (K >= 30) {
                                a.width ^= 0;
                                clearInterval(ad);
                                d = n;
                                t.K = true;
                                a.width ^= 0;
                                AP()
                            }
                            if (L)
                                for (m = ~~(L / 5); m--;)
                                    c.drawImage(a, i = Math.random() * 1280, j = Math.random() * 648, k = Math.random() * 1280, l = Math.random() * 648, i + Math.random() * 100 - 50, j + Math.random() * 100 - 50, k, l);
                            if (J >= 90) {
                                _ = 0;
                                if (n == 1) {
                                    s++;
                                    localStorage["scpm"] = Math.max(+localStorage["scpm"], s)
                                }
                                a.width ^= 0;
                                clearInterval(ad);
                                d = n;
                                t.K = true;
                                a.width ^= 0;
                                AP()
                            }
                            if (K >= 30 || L >= 60) {
                                a.width ^= 0;
                                clearInterval(ad);
                                d = n;
                                t.K = false;
                                a.width ^= 0;
                                AP()
                            }
                        }, 33)
                    }
                    var startImage = new Image();
                    startImage.src = 'img/fondo_info.png';
                    if (d == 3) {
                        c.drawImage(startImage, 160, 80); // Ajusta las coordenadas seg√∫n lo que necesites
                        c.font = "bold 20px arial";
                        c.fillText("EXIT", 1175, 28);
                        c.stroke();
                        c.closePath();
                        c.beginPath();
                        i = A;
                        c.strokeStyle = "red";
                        c.lineWidth = 3;
                        c.rect(8 + i * 35, 3.5, 32, 32);
                        c.stroke();
                        c.closePath()
                    }
                }
                    ;
                onhashchange = function (e, f, g) {
                    if (location.hash) {
                        t = JSON.parse(decodeURIComponent(location.hash.slice(1)));
                        d = 2;
                        AP()
                    }
                }
                    ;
                onhashchange();
                mkaudio = function (fn) {
                    var data = [];
                    for (var i = 0; ; i++) {
                        var smp = fn(i);
                        if (smp === null)
                            break;
                        data.push(smp)
                    }
                    var l = data.length;
                    var l2 = l * 2;
                    var b32 = function (v) {
                        var s = 0;
                        var b = "";
                        for (var i = 0; i < 4; i++,
                            s += 8)
                            b += String.fromCharCode(v >> s & 255);
                        return b
                    };
                    var b16 = function (v) {
                        var b = b32(v);
                        return b[0] + b[1]
                    };
                    var SR = 48E3;
                    var b = "RIFF" + b32(l2 + 36) + "WAVEfmt " + b32(16) + b16(1) + b16(1) + b32(SR) + b32(SR * 2) + b16(2) + b16(16) + "data" + b32(l2);
                    for (var i in data)
                        b += b16(data[i] * 1E4);
                    return new Audio("data:audio/wav;base64," + btoa(b))
                }
                    ;
                P = Math.pow;
                S = Math.sin;
                T = function (i, n) {
                    return (n - i) / n
                }
                    ;
                SNDjump2 = function (i) {
                    i = i * 1.5;
                    var n = 2E4;
                    if (i > n)
                        return null;
                    return (P(i, 1.075) & 128 ? 1 : -1) * P(T(i, n), 2)
                }
                    ;
                SNDdie0 = function (i) {
                    var n = 5E4;
                    if (i > n)
                        return null;
                    return (P(i, .9) & 200 ? 1 : -1) * P(T(i, n), 3)
                }
                    ;
                SNDbrick1 = function (i) {
                    var n = 5E3;
                    if (i > n)
                        return null;
                    return (P(i + S(i * .01) * 1E3, .8) & 200 ? .5 : -.5) * P(T(i, n), 1)
                }
                    ;
                SNDglitch1 = function (i) {
                    var n = 9E4;
                    if (i > n)
                        return null;
                    return (P(i + S(i * .01) * 1E3, .8) & 200 ? .5 : -.5) * P(T(i, n), 1)
                }
                    ;
                SNDcoin1 = function (i) {
                    var n = 16E3;
                    var c = n / 7;
                    if (i > n)
                        return null;
                    var q = P(T(i, n), 2.1);
                    return (i < c ? i + S(-i / 900) * 10 & 16 : i & 13) ? q : -q
                }
                    ;
                SNDI0 = function (i) {
                    var notes = [0, 4, 7, 12, undefined, 7, 12];
                    var n = 4E4;
                    if (i > n)
                        return null;
                    var idx = notes.length * i / n | 0;
                    var note = notes[idx];
                    if (note === undefined)
                        return 0;
                    var r = P(2, note / 12) * .8;
                    var q = T(i * notes.length % n, n);
                    return i * r & 64 ? q : -q
                }
                    ;
                SNDswitch0 = function (i) {
                    var n = 7E3;
                    if (i > n)
                        return null;
                    return ((i ^ i >> 3 ^ i * i * 7.3 ^ i << 4) & 65535) / 65536 * T(i, n)
                }
                    ;
                SNDtimetravel0 = function (i) {
                    var n = 5E4;
                    var n1 = 1E5;
                    if (i > n)
                        return null;
                    i = P(i, 1.2 - S(i / n1)) * 7;
                    var x = S(i / 30 + S(i / 1500));
                    return P(x, 9) * T(i, n)
                }
                    ;
                SNDshoot1 = function (i) {
                    var n = 6E3;
                    if (i > n)
                        return null;
                    var q = T(i, n);
                    return P(i * 50, .7) & 33 ? q : -q
                }
                    ;
                SNDwhatportal2 = function (i) {
                    var n = 1E4;
                    if (i > n)
                        return null;
                    var q = T(i, n);
                    return S(i / 55 * S(i / 99) + S(i / 100)) * q
                }
                    ;
                SNDwhat0 = function (i) {
                    var n = 1E4;
                    if (i > n)
                        return null;
                    var q = T(i, n);
                    return S(i * .01 * S(i * .4) + S(i / 100))
                }
                    ;
                Music = function () {
                    MM = new function () {
                        if (!window.AudioContext)
                            return;
                        var M = this;
                        var ctx = new AudioContext;
                        var node = ctx.createScriptProcessor(4096, 0, 1);
                        var RATE = ctx.sampleRate / 48E3;
                        var POW = Math.pow;
                        var SIN = Math.sin;
                        var RND = Math.random;
                        var NSIN = function (x) {
                            return SIN(x) + RND() * .6
                        };
                        var P2 = Math.PI * 2;
                        var OSC = function (fn) {
                            var x = 0;
                            return function (note) {
                                x += POW(2, note / 12) * RATE;
                                if (x > P2)
                                    x -= P2;
                                return fn(x)
                            }
                        };
                        var snare = OSC(NSIN);
                        var pling = OSC(function (x) {
                            return x / P2 - .5
                        });
                        var pling2 = OSC(function (x) {
                            return x / P2 - .5
                        });
                        var bass = OSC(function (x) {
                            return x / P2 - .5 + POW(SIN(x), 5) * 3
                        });
                        var pos = 1;
                        var step = -1;
                        var vibrato = 0;
                        node.onaudioprocess = function (e) {
                            var data = e.outputBuffer.getChannelData(0);
                            for (var i = 0; i < data.length; i++) {
                                pos += M.t / RATE;
                                vibrato += .001 / RATE;
                                if (pos >= 1) {
                                    pos -= 1;
                                    step++
                                }
                                var decay = 1 - pos;
                                var o = 0;
                                var X = null;
                                var bt = 0;
                                var lseq, lseq2;
                                if (step % 128 < 64) {
                                    lseq = [3, 4, 4, 4, 3, 4, 0, -3, 0, X, X, 0, X, X, 0, X, 3, 4, 4, 4, 3, 4, 0, -3, 0, 12, X, 12, 12, X, X, X];
                                    lseq2 = [X, X, X, X, X, X, X, X, X, X, X, X, X, X, X, X, -1, 0, 0, 0, -1, 0, -5, -8, -5, X, X, -5, X, X, -5, X, X]
                                } else {
                                    lseq = [6, 7, 7, 7, 6, 5, 4, 2, -5, X, X, 7, X, X, X];
                                    lseq2 = [X, X, X, X, -10, -5, X, X, X, -10];
                                    bt = -5
                                }
                                var L = lseq.length;
                                var ln = lseq[step % L];
                                if (ln != X)
                                    o += pling(-81 + ln + 24) * decay * M.p;
                                L = lseq2.length;
                                var ln = lseq2[step % L];
                                if (ln != X)
                                    o += pling2(-81 + ln + 24 + SIN(vibrato) * .05) * decay * M.p;
                                var bseq = [0, X, X, 0, 7, 9, X, 7];
                                L = bseq.length;
                                var bseq2 = [X, 12, X, 12, 12, X, 12, X];
                                var bn = ((step / L & 3) < 3 ? bseq : bseq2)[step % L];
                                if (bn != X)
                                    o += bass(-81 + bn + bt - SIN(vibrato) * .05) * M.b * decay;
                                var drumx = (1 - pos + (step & 1)) / 2;
                                if ((step & 2) == 2)
                                    o += snare(-70 + POW(drumx, 15) * 60) * M.s * decay * RND();
                                data[i] = o
                            }
                        }
                            ;
                        node.connect(ctx.destination);
                        M.stop = function () {
                            node.disconnect()
                        }
                            ;
                        M.s = .1;
                        M.p = .2;
                        M.b = .2;
                        M.t = 1.1E-4
                    }
                }
                    ;
                Music();
                function SNDcoin1(i) {
                    var n = 1.6e4;
                    var c = n / 7;
                    if (i > n)
                        return null;
                    var q = P(T(i, n), 2.1);
                    return (i < c ? ((i + S(-i / 900) * 10) & 16) : i & 13) ? q : -q;
                }
            </script>